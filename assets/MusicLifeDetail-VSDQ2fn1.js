import{x as j,r as a,U as C,u as f,a8 as s,j as t}from"./index-BryaZ5dw.js";function p(){const{id:n}=j(),[i,c]=a.useState(null),[m,r]=a.useState([]),[u,d]=a.useState(""),{user:o}=a.useContext(C),l=f();a.useEffect(()=>{s.getPost(n).then(c),s.getComments(n).then(r)},[n]);const h=async e=>{e.preventDefault(),await s.addComment(n,{content:u,authorId:o.uid,authorName:o.nickname}),d(""),r(await s.getComments(n))},x=async()=>{window.confirm("정말 삭제하시겠습니까?")&&(await s.deletePost(n),l("/musiclife"))};return i?t.jsxs("div",{children:[t.jsx("h2",{children:i.title}),t.jsx("div",{children:i.content}),t.jsxs("div",{children:["작성자: ",i.authorName," | 조회수: ",i.viewCount]}),o.uid===i.authorId&&t.jsx("button",{onClick:x,children:"삭제"}),t.jsx("hr",{}),t.jsx("h3",{children:"댓글"}),t.jsxs("form",{onSubmit:h,children:[t.jsx("input",{value:u,onChange:e=>d(e.target.value),required:!0}),t.jsx("button",{type:"submit",children:"댓글 등록"})]}),t.jsx("ul",{children:m.map(e=>t.jsxs("li",{children:[t.jsx("b",{children:e.authorName}),": ",e.content,o.uid===e.authorId&&t.jsx("button",{onClick:async()=>{await s.deleteComment(n,e.id),r(await s.getComments(n))},children:"삭제"})]},e.id))})]}):t.jsx("div",{children:"로딩 중..."})}export{p as default};
